<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
    xmlns:sec="http://www.thymeleaf.org/extras/spring-security" lang="en">

<head>
    <th:block th:include="components/account/admin-head :: admin-head"></th:block>

</head>
<body class="animsition">
	<div class="page-wrapper">
       		<div th:replace="components/account/account-header :: account-header"></div>
       		<div class="page-container">
				<div th:replace="components/admin/admin-menu :: admin-menu"></div>
				<div th:replace="components/account/account-list :: account-body"></div>
        	</div>
        	
	</div>					
    <th:block th:replace="components/admin/admin-footer :: admin-footer"></th:block>
    <script th:inline="javascript"  >
        function DeleteAccount(i) {
        	const accounts = [[${ pageable.data }]]
            var token = $("meta[name='_csrf']").attr("content");
            var header = $("meta[name='_csrf_header']").attr("content");
        Swal.fire({
                title: 'Are you sure?',
                text: "You won't be able to revert this!",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Yes, delete it!'
            }).then((result) => {

                if (result.value) {
                    $.ajax({
                        url: `/admin/account/delete/${accounts[i].accountId}`,
                        type: 'DELETE',
                        beforeSend: function (xhr) {
                            xhr.setRequestHeader(header, token);
                        },

                        success: function (data, status, xhr) {
                            Swal.fire({
                                position: 'center',
                                icon: 'success',
                                title: 'Active Success',
                                showConfirmButton: false,
                                timer: 800
                            }).then(() => {
                                window.location.href = window.location.href;

                            })
                        },
                        error: function (request, status, error) {
                            alert(status);
                            // To reload the page discarding the POST data(perform a GET request)
                            window.location.href = window.location.href;
                        } 
                    });
                }
            }) 
        }
      </script>
</body>
</html>